<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#A10054" />
  <title>Hitachi Axis — TWA Full-Screen Demo</title>

  <style>
    html, body {
      touch-action: pan-x pan-y; /* disables pinch zoom */
      -ms-touch-action: pan-x pan-y;
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    *, *::before, *::after { box-sizing: border-box }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
      color: #0e0e0e;
      background: #fafafa;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }

    :root {
      --axis:#A10054;
      --hitachi:#E60012;
      --ink:#111827;
      --muted:#6b7280;
      --bg:#f8fafc;
      --card:#ffffff;
      --shadow:0 10px 30px rgba(0,0,0,.06), 0 2px 10px rgba(0,0,0,.04);
      --radius:20px;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: linear-gradient(90deg,var(--axis),var(--hitachi));
      color: #fff;
      box-shadow: var(--shadow);
    }

    .safe{padding:env(safe-area-inset-top,0) env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0)}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}
    .topbar{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:700;}
    nav.actions{display:flex;gap:10px}
    .btn{appearance:none;border:0;border-radius:999px;padding:10px 16px;font-weight:600;cursor:pointer}
    .btn.solid{background:#fff;color:#111}
    .btn.ghost{background:rgba(255,255,255,.16);color:#fff}
    .btn.outline{background:transparent;color:var(--axis);outline:2px solid rgba(161,0,84,.3)}

    .hero{min-height:calc(100svh - 64px);display:grid;place-items:center;}
    .card{background:var(--card);border-radius:16px;padding:20px;box-shadow:var(--shadow)}
    .cta{display:flex;flex-wrap:wrap;gap:12px}

    .field{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(0,0,0,.12);}
    .file-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:12px}
    .muted{color:var(--muted)}

    #printArea{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:12px;min-height:120px;display:grid;place-items:center;overflow:hidden}
    #printArea img{max-width:100%;height:auto;display:block}
    #printArea iframe{width:100%;height:400px;border:0}
    #printArea pre{margin:0;padding:16px;white-space:pre-wrap;word-break:break-word;width:100%}
    .placeholder{padding:28px;color:var(--muted)}

    .toast{position:fixed;left:50%;bottom:calc(env(safe-area-inset-bottom,0) + 20px);
      transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;
      border-radius:999px;box-shadow:var(--shadow);opacity:0;transition:opacity .25s, transform .25s;
      pointer-events:none}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-4px)}
  </style>
</head>

<body class="safe">
  <header class="safe">
    <div class="container topbar">
      <div class="brand">
        <strong>Hitachi Axis</strong>
      </div>
      <nav class="actions">
        <button class="btn solid" onclick="printPage()">Print Page</button>
      </nav>
    </div>
  </header>

  <main class="safe">
    <div class="container">
      <section class="card" style="margin-top:20px">
        <h2>Upload & Print</h2>
        <p class="muted">Upload an image, PDF, or text file to preview and print the image only.</p>

        <div class="file-row">
          <input id="fileInput" type="file" class="field" accept="image/*,application/pdf,text/plain" />
          <button class="btn solid" onclick="printUploaded()">Print Uploaded</button>
          <span id="fileName" class="muted"></span>
        </div>

        <div id="printArea">
          <div class="placeholder">No file selected yet.</div>
        </div>
      </section>
    </div>
  </main>

  <footer class="safe" style="text-align:center;padding:20px;">
    © <span id="year"></span> Hitachi Axis (Demo)
  </footer>

  <div class="toast" aria-live="polite"></div>

  <script>
    // Toast helper
    function toaster(msg){
      let t=document.querySelector('.toast');
      if(!t){t=document.createElement('div');t.className='toast';document.body.appendChild(t)}
      t.textContent=msg;
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'),1800);
    }

    // Print the whole page normally
    function printPage(){
      toaster('Opening system print dialog...');
      window.print();
    }

    const fileInput = document.getElementById('fileInput');
    const fileNameEl = document.getElementById('fileName');
    const printArea = document.getElementById('printArea');

    fileInput.addEventListener('change', async (e) => {
      const file = e.target.files?.[0];
      printArea.innerHTML = '';
      fileNameEl.textContent = '';

      if (!file) {
        printArea.innerHTML = '<div class="placeholder">No file selected yet.</div>';
        return;
      }

      fileNameEl.textContent = file.name;
      const type = file.type || '';
      const url = URL.createObjectURL(file);

      if (type.startsWith('image/')) {
        const img = document.createElement('img');
        img.src = url;
        img.alt = file.name;
        printArea.appendChild(img);
        toaster('Image ready for print.');
        return;
      }

      if (type === 'application/pdf') {
        const iframe = document.createElement('iframe');
        iframe.src = url;
        printArea.appendChild(iframe);
        toaster('PDF preview shown (only images can be printed).');
        return;
      }

      if (type === 'text/plain' || file.name.endsWith('.txt')) {
        const text = await file.text();
        const pre = document.createElement('pre');
        pre.textContent = text;
        printArea.appendChild(pre);
        toaster('Text preview shown (only images can be printed).');
        return;
      }

      printArea.innerHTML = '<div class="placeholder">Unsupported file type. Please upload an image.</div>';
    });

    // ✅ Print only the uploaded image
    function printUploaded(){
      const img = document.querySelector('#printArea img');
      if (!img) {
        toaster('Please upload an image first.');
        return;
      }

      const w = window.open('', '_blank', 'noopener,noreferrer');
      if (!w) {
        toaster('Popup blocked. Allow popups to print.');
        return;
      }

      // Minimal printable HTML
      w.document.write(`
        <!doctype html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>Print</title>
          <style>
            @page { margin: 0; }
            html, body { margin: 0; padding: 0; }
            img { width: 100%; height: auto; display: block; }
          </style>
        </head>
        <body>
          <img src="${img.src}" alt="print">
        </body>
        </html>
      `);
      w.document.close();

      const wImg = w.document.querySelector('img');
      const onReady = () => { w.focus(); w.print(); w.close(); };
      if (wImg.complete) onReady();
      else {
        wImg.onload = onReady;
        wImg.onerror = () => { w.close(); toaster('Could not load image for printing.'); };
      }
    }

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
